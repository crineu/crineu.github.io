<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <link rel="icon" href="data:;base64,="> <!-- evita favicon.ico  -->

    <title>Idades de crianças | crineu.github.io</title>
    <meta name="description" content="Cálculos de idades de crianças" />
    <link rel="canonical" href="https://crineu.github.io/" />
    <meta property="og:url" content="https://crineu.github.io/" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <link rel="stylesheet" href="./style.css">

    <script src="./dayjs.min.js"></script>
    <script src="./pt-br.min.js"></script>
    <script src="./localizedFormat.min.js"></script>
</head>


<body>
    <section class="page-header">
        <h1 class="project-name">Meus piá em
            <input id="date_input" type="date" class="btn" onchange="atualizaCalculos(event);">
        </h1>
        <h2 class="project-tagline">Cálculo da idade das criança</h2>
    </section>

    <section class="main-content">

        <h1 id="henriquinho--">Henriquinho | <strong><span id="id_age_henry"></span></strong></h1>

        <blockquote>
            <p><span id="id_bday_henry"></span> (~ <span id="id_days_henry"></span> dias)</p>
        </blockquote>

        <p>Translação terrestre em <strong><span id="id_next_henry"></span></strong></p>

        <p>Tinha a idade do mano mais ou menos em <strong><span id="id_past_henry"></span></strong></p>

        <hr />

        <p><strong><span id="id_age_diff"></span></strong> depois…</p>

        <hr />
        <h1 id="eduardinho--">Eduardinho | <strong><span id="id_age_diddy"></span></strong></h1>

        <blockquote>
            <p><span id="id_bday_diddy"></span>  (~ <span id="id_days_diddy"></span> dias)</p>
        </blockquote>

        <p>Translação terrestre em <strong><span id="id_next_diddy"></span></strong></p>
        <p>Terá a idade do mano ali por <strong><span id="id_futu_diddy"></span></strong></p>

        <footer class="site-footer">
            <span class="site-footer-credits">This page was generated by myself.</span>
        </footer>
    </section>


    <!-- Conferência https://calculocorreto.com/diferenca-entre-datas/ -->
    <script type="text/javascript">
        dayjs().format();
        dayjs.locale('pt-br');    // use locale globally
        dayjs.extend(window.dayjs_plugin_localizedFormat);

        // const HENRY = dayjs('2013-08-26T09:02-0300');
        // const DIDDY = dayjs('2016-12-01T18:05-0300');
        const HENRY = dayjs('2013-08-26');
        const DIDDY = dayjs('2016-12-01');
        document.getElementById("id_bday_henry").innerHTML = HENRY.format('LL');
        document.getElementById("id_bday_diddy").innerHTML = DIDDY.format('LL');
        document.getElementById("id_age_diff").innerHTML = data_dif(HENRY, DIDDY);

        document.getElementById("date_input").value = dayjs().format('YYYY-MM-DD');
        atualizaCalculos();

        function atualizaCalculos() {
            const BASE = dayjs(document.getElementById("date_input").value);

            document.getElementById("id_age_henry").innerHTML  = data_dif(HENRY, BASE);
            document.getElementById("id_age_diddy").innerHTML  = data_dif(DIDDY, BASE);
            document.getElementById("id_days_henry").innerHTML = total_dias(HENRY, BASE);
            document.getElementById("id_days_diddy").innerHTML = total_dias(DIDDY, BASE);


            var idade_henry = BASE.diff(HENRY, 'year');
            var idade_diddy = BASE.diff(DIDDY, 'year');
            var prox_niver_henry = HENRY.add(idade_henry + 1, 'year');
            var prox_niver_diddy = DIDDY.add(idade_diddy + 1, 'year');

            document.getElementById("id_next_henry").innerHTML = data_dif(BASE, prox_niver_henry);
            document.getElementById("id_next_diddy").innerHTML = data_dif(BASE, prox_niver_diddy);


            var idade_henry_dias = BASE.diff(HENRY, 'days');
            var idade_diddy_dias = BASE.diff(DIDDY, 'days');
            var henry_com_idade_diddy = HENRY.add(idade_diddy_dias, 'days');
            var diddy_com_idade_henry = DIDDY.add(idade_henry_dias, 'days');

            document.getElementById("id_past_henry").innerHTML = henry_com_idade_diddy.format('LL');
            document.getElementById("id_futu_diddy").innerHTML = diddy_com_idade_henry.format('LL');
        }

        // Math.floor...toLocaleString para formatar casa de milhar: 2000 => 2.000
        function total_dias(dataAnterior, dataRecente) {
            return Math
                .floor(dataRecente.diff(dataAnterior, 'day'))
                .toLocaleString('pt');
        }

        function data_dif(dataAnterior, dataRecente) {
            var text  = "";
            var anos  = dataRecente.diff(dataAnterior, 'year');
            var meses = dataRecente.diff(dataAnterior, 'month') - (anos * 12);
            var dias  = dataRecente.diff(dataAnterior.add(anos, 'year').add(meses, 'month'), 'day');

            if (anos != 0) {
                text += anos + (Math.abs(anos) < 2 ? " ano, " : " anos, ");
            }
            if (meses != 0) {
                text += meses + (Math.abs(meses) < 2 ? " mês e " : " meses e ");
            }
            if (dias != 0) {
                text += dias + (dias == 1 ? " dia" : " dias ");
            }
            return text;
        }
    </script>

</body>
</html>
